raster = TRUE,
interpolate = TRUE
)
)
print(p1, split=c(1,1,2,2), more=TRUE)
print(p2, split=c(2,1,2,2), more=TRUE)
print(p3, split=c(1,2,2,2), more=TRUE)
print(p4, split=c(2,2,2,2))
# Aragonite saturation state
r <- mask(subset(cimp5_2041_2060_exsd, 10), mask200)
lim <- maxValue(abs(r))
key.col <- jet.colors3.key(r)
p5 <- mplot(r, col.regions=jet.colors3,
at=seq(-lim, lim, len=101),
main=expression(Omega[aragonite]),
colorkey = list(space = "top",
col = key.col[[2]],
at = key.col[[1]],
raster = TRUE,
interpolate = TRUE
)
)
# Calcite saturation state
r <- mask(subset(cimp5_2041_2060_exsd, 11), mask200)
lim <- maxValue(abs(r))
key.col <- jet.colors3.key(r)
p5 <- mplot(r, col.regions=jet.colors3,
at=seq(-lim, lim, len=101),
main=expression(Omega[calcite]),
colorkey = list(space = "top",
col = key.col[[2]],
at = key.col[[1]],
raster = TRUE,
interpolate = TRUE
)
)
print(p5, split=c(1,1,2,1), more=TRUE)
print(p6, split=c(2,1,2,1))
# Export POC Flux
r <- mask(subset(cimp5_2081_2100_exsd, 1), mask200)
lim <- maxValue(abs(r))
key.col <- jet.colors3.key(r)
p1 <- mplot(r, col.regions=jet.colors3,
at=seq(-lim, lim, len=101),
main="Export POC Flux",
colorkey = list(space = "top",
col = key.col[[2]],
at = key.col[[1]],
raster = TRUE,
interpolate = TRUE
)
)
# Dissolved oxygen
r <- mask(subset(cimp5_2081_2100_exsd, 2), mask200)
lim <- maxValue(abs(r))
key.col <- jet.colors3.key(r)
p2 <- mplot(r, col.regions=jet.colors3,
at=seq(-lim, lim, len=101),
main="Dissolved Oxygen",
colorkey = list(space = "top",
col = key.col[[2]],
at = key.col[[1]],
raster = TRUE,
interpolate = TRUE
)
)
# pH
r <- mask(subset(cimp5_2081_2100_exsd, 3), mask200)
lim <- maxValue(abs(r))
key.col <- jet.colors3.key(r)
p3 <- mplot(r, col.regions=jet.colors3,
at=seq(-lim, lim, len=101),
main="pH",
colorkey = list(space = "top",
col = key.col[[2]],
at = key.col[[1]],
raster = TRUE,
interpolate = TRUE
)
)
# Temperature
r <- mask(subset(cimp5_2081_2100_exsd, 4), mask200)
lim <- maxValue(abs(r))
key.col <- jet.colors3.key(r)
p4 <- mplot(r, col.regions=jet.colors3,
at=seq(-lim, lim, len=101),
main="Temperature",
colorkey = list(space = "top",
col = key.col[[2]],
at = key.col[[1]],
raster = TRUE,
interpolate = TRUE
)
)
print(p1, split=c(1,1,2,2), more=TRUE)
print(p2, split=c(2,1,2,2), more=TRUE)
print(p3, split=c(1,2,2,2), more=TRUE)
print(p4, split=c(2,2,2,2))
# Aragonite saturation state
r <- mask(subset(cimp5_2081_2100_exsd, 10), mask200)
lim <- maxValue(abs(r))
key.col <- jet.colors3.key(r)
p5 <- mplot(r, col.regions=jet.colors3,
at=seq(-lim, lim, len=101),
main=expression(Omega[aragonite]),
colorkey = list(space = "top",
col = key.col[[2]],
at = key.col[[1]],
raster = TRUE,
interpolate = TRUE
)
)
# Calcite saturation state
r <- mask(subset(cimp5_2081_2100_exsd, 11), mask200)
lim <- maxValue(abs(r))
key.col <- jet.colors3.key(r)
p5 <- mplot(r, col.regions=jet.colors3,
at=seq(-lim, lim, len=101),
main=expression(Omega[calcite]),
colorkey = list(space = "top",
col = key.col[[2]],
at = key.col[[1]],
raster = TRUE,
interpolate = TRUE
)
)
print(p5, split=c(1,1,2,1), more=TRUE)
print(p6, split=c(2,1,2,1))
# Aragonite saturation state
r <- mask(subset(cimp5_2081_2100_exsd, 10), mask200)
lim <- maxValue(abs(r))
key.col <- jet.colors3.key(r)
p5 <- mplot(r, col.regions=jet.colors3,
at=seq(-lim, lim, len=101),
main=expression(Omega[aragonite]),
colorkey = list(space = "top",
col = key.col[[2]],
at = key.col[[1]],
raster = TRUE,
interpolate = TRUE
)
)
# Calcite saturation state
r <- mask(subset(cimp5_2081_2100_exsd, 11), mask200)
lim <- maxValue(abs(r))
key.col <- jet.colors3.key(r)
p6 <- mplot(r, col.regions=jet.colors3,
at=seq(-lim, lim, len=101),
main=expression(Omega[calcite]),
colorkey = list(space = "top",
col = key.col[[2]],
at = key.col[[1]],
raster = TRUE,
interpolate = TRUE
)
)
print(p5, split=c(1,1,2,1), more=TRUE)
print(p6, split=c(2,1,2,1))
levs <- c(0:12, 53, 56)
labs <-c("Land mass", "Atlantic Ocean", "Pacific Ocean", "Indian Ocean", "Mediterranean Sea", "Baltic Sea", "Black Sea", "Red Sea", "Persian Gulf", "Hudson Bay", "Southern Ocean", "Arctic Ocean", "Sea of Japan", "Caspian Sea", "Bay of Bengal")
mplot(mk, col.regions=rainbow, at=c(0:12, 53,56), colorkey=F)
names(cimp5_2041_2060_exsd)
env <- mask(cimp5_2041_2060_exsd, mask200)
bas <- mask(mk, mask200)
dat <- cbind(as.data.frame(env), as.data.frame(bas))
dat <- subset(dat, !is.na(Basin_0m))
dat$Basin_0m <- factor(dat$Basin_0m, levels=levs, labels=labs)
sta <- summaryBy(epc_exsd_2041_to_2060+o2_exsd_2041_to_2060+ph_exsd_2041_to_2060+thetao_exsd_2041_to_2060+aragsat_exsd_2041_to_2060+calcsat_exsd_2041_to_2060~Basin_0m, data=dat, var.names=c("epc", "o2", "ph", "thetao"), FUN=c(mean, min, max))
ord <- c(2, 8, 14)
sta <- sta[, c(1, ord, ord+1, ord+2, ord+3, ord+4 , ord+5)]
sta[, -1] <- round(sta[, -1], 2)
kable(sta, caption = "Exposure to Climate change hazards beyound 200 m by 2041 to 2060")
env <- mask(cimp5_2041_2060_exsd, mask200)
bas <- mask(mk, mask200)
dat <- cbind(as.data.frame(env), as.data.frame(bas))
dat <- subset(dat, !is.na(Basin_0m))
dat$Basin_0m <- factor(dat$Basin_0m, levels=levs, labels=labs)
sta <- summaryBy(epc_exsd_2041_to_2060+o2_exsd_2041_to_2060+ph_exsd_2041_to_2060+thetao_exsd_2041_to_2060+aragsat_exsd_2041_to_2060+calcsat_exsd_2041_to_2060~Basin_0m, data=dat, var.names=c("epc", "o2", "ph", "thetao", "aragsat", "calcsat"), FUN=c(mean, min, max))
ord <- c(2, 8, 14)
sta <- sta[, c(1, ord, ord+1, ord+2, ord+3, ord+4 , ord+5)]
sta[, -1] <- round(sta[, -1], 2)
kable(sta, caption = "Exposure to Climate change hazards beyound 200 m by 2041 to 2060")
env <- mask(cimp5_2041_2060_exsd, mask200)
bas <- mask(mk, mask200)
dat <- cbind(as.data.frame(env), as.data.frame(bas))
dat <- subset(dat, !is.na(Basin_0m))
dat$Basin_0m <- factor(dat$Basin_0m, levels=levs, labels=labs)
sta <- summaryBy(epc_exsd_2041_to_2060+o2_exsd_2041_to_2060+ph_exsd_2041_to_2060+thetao_exsd_2041_to_2060+aragsat_exsd_2041_to_2060+calcsat_exsd_2041_to_2060~Basin_0m, data=dat, var.names=c("epc", "o2", "ph", "thetao", "aragsat", "calcsat"), FUN=c(mean, min, max))
ord <- c(2, 8, 14)
sta <- sta[, c(1, ord, ord+1, ord+2, ord+3, ord+4 , ord+5)]
sta[, -1] <- round(sta[, -1], 2)
kable(sta, caption = "Exposure to Climate change hazards beyound 200 m by 2041 to 2060")
library(doBy)
library(knitr)
library(ggplot2)
library(reshape2)
env <- mask(cimp5_2041_2060_exsd, mask200)
bas <- mask(mk, mask200)
dat <- cbind(as.data.frame(env), as.data.frame(bas))
dat <- subset(dat, !is.na(Basin_0m))
dat$Basin_0m <- factor(dat$Basin_0m, levels=levs, labels=labs)
sta <- summaryBy(epc_exsd_2041_to_2060+o2_exsd_2041_to_2060+ph_exsd_2041_to_2060+thetao_exsd_2041_to_2060+aragsat_exsd_2041_to_2060+calcsat_exsd_2041_to_2060~Basin_0m, data=dat, var.names=c("epc", "o2", "ph", "thetao", "aragsat", "calcsat"), FUN=c(mean, min, max))
ord <- c(2, 8, 14)
sta <- sta[, c(1, ord, ord+1, ord+2, ord+3, ord+4 , ord+5)]
sta[, -1] <- round(sta[, -1], 2)
kable(sta, caption = "Exposure to Climate change hazards beyound 200 m by 2041 to 2060")
long <- melt(dat, id.vars="Basin_0m", measure.vars = names(dat)[c(1:4, 10:11)])
long$Basin_0m <- factor(long$Basin_0m, levels=as.character(sta$Basin_0m)[order(sta$thetao.mean)])
long$variable <- factor(long$variable, levels=names(dat)[c(1:4, 10:11)],
labels = c("Export POC Flux", "Dissolved Oxygen",
"pH", "Temperature", "Aragonite Saturation", "Calcite Saturation"))
ggplot(data=long, aes(x=Basin_0m, y=value))+
geom_violin(draw_quantiles=0.5, scale="width")+
xlab("")+ylab("Exposure to Climate change hazards by 2041 to 2060")+
facet_wrap(~variable, scale="free_y")+
theme(axis.text.x = element_text(angle = 30, hjust = 1))
other <- mask(rasterize(Other_access_regulated_areas, cimp5_2041_2060_exsd), mask200)
dat <- cbind(as.data.frame(env), as.data.frame(other))
dat <- subset(dat, !is.na(OWNER))
dat$OWNER <- factor(dat$OWNER)
sta <- summaryBy(formula(paste(paste(names(dat)[c(1:4, 10:11)], collapse = "+"), "OWNER", sep="~")),
data=dat, var.names=c("epc", "o2", "ph", "thetao", "aragsat", "calcsat"), FUN=c(mean, min, max))
ord <- c(2, 8, 14)
sta <- sta[, c(1, ord, ord+1, ord+2, ord+3, ord+4 , ord+5)]
sta[, -1] <- round(sta[, -1], 2)
kable(sta, caption = "Exposure to Climate change hazards beyound 200 m by 2041 to 2060")
other <- mask(rasterize(Other_access_regulated_areas, cimp5_2041_2060_exsd), mask200)
dat <- cbind(as.data.frame(env), as.data.frame(other))
dat <- subset(dat, !is.na(OWNER))
dat$OWNER <- factor(dat$OWNER)
sta <- summaryBy(formula(paste(paste(names(dat)[c(1:4, 10:11)], collapse = "+"), "OWNER", sep="~")),
data=dat, var.names=c("epc", "o2", "ph", "thetao", "aragsat", "calcsat"), FUN=c(mean, min, max))
ord <- c(2, 8, 14)
sta <- sta[, c(1, ord, ord+1, ord+2, ord+3, ord+4 , ord+5)]
sta[, -1] <- round(sta[, -1], 2)
kable(sta, caption = "Exposure to Climate change hazards beyound 200 m by 2041 to 2060")
long <- melt(dat, id.vars="OWNER", measure.vars = names(dat)[c(1:4, 10:11)])
long$OWNER <- factor(long$OWNER, levels=as.character(sta$OWNER)[order(sta$thetao.mean)])
long$variable <- factor(long$variable, levels=names(dat)[c(1:4, 10:11)],
labels = c("Export POC Flux", "Dissolved Oxygen",
"pH", "Temperature", "Aragonite Saturation", "Calcite Saturation"))
ggplot(data=long, aes(x=OWNER, y=value))+
geom_violin(draw_quantiles=0.5, scale="width")+
xlab("")+ylab("Exposure to Climate change hazards by 2041 to 2060")+
facet_wrap(~variable, scale="free_y")+
theme(axis.text.x = element_text(angle = 30, hjust = 1))
names(cimp5_2041_2060_exsd)
env <- mask(cimp5_2041_2060_exsd, mask2500)
bas <- mask(mk, mask2500)
dat <- cbind(as.data.frame(env), as.data.frame(bas))
dat <- subset(dat, !is.na(Basin_0m))
dat$Basin_0m <- factor(dat$Basin_0m, levels=levs, labels=labs)
sta <- summaryBy(epc_exsd_2041_to_2060+o2_exsd_2041_to_2060+ph_exsd_2041_to_2060+thetao_exsd_2041_to_2060+aragsat_exsd_2041_to_2060+calcsat_exsd_2041_to_2060~Basin_0m, data=dat, var.names=c("epc", "o2", "ph", "thetao", "aragsat", "calcsat"), FUN=c(mean, min, max))
ord <- c(2, 8, 14)
sta <- sta[, c(1, ord, ord+1, ord+2, ord+3, ord+4 , ord+5)]
sta[, -1] <- round(sta[, -1], 2)
kable(sta, caption = "Exposure to Climate change hazards betwenn 200 and 2500 m by 2041 to 2060")
env <- mask(cimp5_2041_2060_exsd, mask2500)
bas <- mask(mk, mask2500)
dat <- cbind(as.data.frame(env), as.data.frame(bas))
dat <- subset(dat, !is.na(Basin_0m))
dat$Basin_0m <- factor(dat$Basin_0m, levels=levs, labels=labs)
sta <- summaryBy(epc_exsd_2041_to_2060+o2_exsd_2041_to_2060+ph_exsd_2041_to_2060+thetao_exsd_2041_to_2060+aragsat_exsd_2041_to_2060+calcsat_exsd_2041_to_2060~Basin_0m, data=dat, var.names=c("epc", "o2", "ph", "thetao", "aragsat", "calcsat"), FUN=c(mean, min, max))
ord <- c(2, 8, 14)
sta <- sta[, c(1, ord, ord+1, ord+2, ord+3, ord+4 , ord+5)]
sta[, -1] <- round(sta[, -1], 2)
kable(sta, caption = "Exposure to Climate change hazards betwenn 200 and 2500 m by 2041 to 2060")
long <- melt(dat, id.vars="Basin_0m", measure.vars = names(dat)[c(1:4, 10:11)])
long$Basin_0m <- factor(long$Basin_0m, levels=as.character(sta$Basin_0m)[order(sta$thetao.mean)])
long$variable <- factor(long$variable, levels=names(dat)[c(1:4, 10:11)],
labels = c("Export POC Flux", "Dissolved Oxygen",
"pH", "Temperature", "Aragonite Saturation", "Calcite Saturation"))
ggplot(data=long, aes(x=Basin_0m, y=value))+
geom_violin(draw_quantiles=0.5, scale="width")+
xlab("")+ylab("Exposure to Climate change hazards by 2041 to 2060")+
facet_wrap(~variable, scale="free_y")+
theme(axis.text.x = element_text(angle = 30, hjust = 1))
other <- mask(rasterize(Other_access_regulated_areas, cimp5_2041_2060_exsd), mask2500)
dat <- cbind(as.data.frame(env), as.data.frame(other))
dat <- subset(dat, !is.na(OWNER))
dat$OWNER <- factor(dat$OWNER)
sta <- summaryBy(formula(paste(paste(names(dat)[c(1:4, 10:11)], collapse = "+"), "OWNER", sep="~")),
data=dat, var.names=c("epc", "o2", "ph", "thetao", "aragsat", "calcsat"), FUN=c(mean, min, max))
ord <- c(2, 8, 14)
sta <- sta[, c(1, ord, ord+1, ord+2, ord+3, ord+4 , ord+5)]
sta[, -1] <- round(sta[, -1], 2)
kable(sta, caption = "Exposure to Climate change hazards beyound 200 m by 2041 to 2060")
other <- mask(rasterize(Other_access_regulated_areas, cimp5_2041_2060_exsd), mask2500)
dat <- cbind(as.data.frame(env), as.data.frame(other))
dat <- subset(dat, !is.na(OWNER))
dat$OWNER <- factor(dat$OWNER)
sta <- summaryBy(formula(paste(paste(names(dat)[c(1:4, 10:11)], collapse = "+"), "OWNER", sep="~")),
data=dat, var.names=c("epc", "o2", "ph", "thetao", "aragsat", "calcsat"), FUN=c(mean, min, max))
ord <- c(2, 8, 14)
sta <- sta[, c(1, ord, ord+1, ord+2, ord+3, ord+4 , ord+5)]
sta[, -1] <- round(sta[, -1], 2)
kable(sta, caption = "Exposure to Climate change hazards beyound 200 m by 2041 to 2060")
long <- melt(dat, id.vars="OWNER", measure.vars = names(dat)[c(1:4, 10:11)])
long$OWNER <- factor(long$OWNER, levels=as.character(sta$OWNER)[order(sta$thetao.mean)])
long$variable <- factor(long$variable, levels=names(dat)[c(1:4, 10:11)],
labels = c("Export POC Flux", "Dissolved Oxygen",
"pH", "Temperature", "Aragonite Saturation", "Calcite Saturation"))
ggplot(data=long, aes(x=OWNER, y=value))+
geom_violin(draw_quantiles=0.5, scale="width")+
xlab("")+ylab("Exposure to Climate change hazards by 2041 to 2060")+
facet_wrap(~variable, scale="free_y")+
theme(axis.text.x = element_text(angle = 30, hjust = 1))
#library(devtools)
#install_github("chihlinwei/SCC")
library(SCC)
library(RColorBrewer)
mask200 <- calc(etopo1, fun=function(x){x[x>-200]<-NA; return(x)})
d.colors <- colorRampPalette(brewer.pal(10, 'RdYlBu'))
cor(as.data.frame(cimp5_sdtoe_early), as.data.frame(cimp5_sdtoe_constant), use="pairwise.complete.obs")
r <- mask(cimp5_sdtoe_early, mask200)
mplot(r, col.regions=d.colors, cut=100, colorkey=list(space="top"),
names.attr = c("Export_POC_Flux", "Dissolved_Oxygen", "pH", "Temperature"),
main="Time of Emergence of Climate Change on Seafloor"
)
cimp5_sdtoe_early
names(cimp5_sdtoe_early)
r <- mask(subset(cimp5_sdtoe_early, 1:4), mask200)
mplot(r, col.regions=d.colors, cut=100, colorkey=list(space="top"),
names.attr = c("Export_POC_Flux", "Dissolved_Oxygen", "pH", "Temperature"),
main="Time of Emergence of Climate Change on Seafloor"
)
overlay(subset(cimp5_sdtoe_early, 1:4), fun=max)
r <- mask(overlay(subset(cimp5_sdtoe_early, 1:4), fun=max), mask200)
mplot(r, col.regions=d.colors, cut=100, colorkey=list(space="top"),
#names.attr = c("Export_POC_Flux", "Dissolved_Oxygen", "pH", "Temperature"),
main="Time of Emergence of Climate Change on Seafloor"
)
r <- mask(overlay(subset(cimp5_sdtoe_early, 1:4), fun=mean), mask200)
p1 <- mplot(r, col.regions=d.colors, cut=100, colorkey=list(space="top"),
main="Mean Time of Emergence of Climate Change on Seafloor"
)
r <- mask(overlay(subset(cimp5_sdtoe_early, 1:4), fun=max), mask200)
p2 <- mplot(r, col.regions=d.colors, cut=100, colorkey=list(space="top"),
main="Maximum Time of Emergence of Climate Change on Seafloor"
)
print(p1, split=c(1,1,2,1), more=TRUE)
print(p2, split=c(2,1,2,1))
r <- mask(overlay(subset(cimp5_sdtoe_early, 1:4), fun=mean), mask200)
p1 <- mplot(r, col.regions=d.colors, cut=100, colorkey=list(space="top"),
main="Mean ToE of Climate Change on Seafloor"
)
r <- mask(overlay(subset(cimp5_sdtoe_early, 1:4), fun=max), mask200)
p2 <- mplot(r, col.regions=d.colors, cut=100, colorkey=list(space="top"),
main="Maximum ToE of Climate Change on Seafloor"
)
print(p1, split=c(1,1,2,1), more=TRUE)
print(p2, split=c(2,1,2,1))
levs <- c(0:12, 53, 56)
labs <-c("Land mass", "Atlantic Ocean", "Pacific Ocean", "Indian Ocean", "Mediterranean Sea", "Baltic Sea", "Black Sea", "Red Sea", "Persian Gulf", "Hudson Bay", "Southern Ocean", "Arctic Ocean", "Sea of Japan", "Caspian Sea", "Bay of Bengal")
mplot(mk, col.regions=rainbow, at=c(0:12, 53,56), colorkey=F)
r <- mask(overlay(subset(cimp5_sdtoe_early, 1:4), fun=mean), mask200)
p1 <- mplot(r, col.regions=d.colors, cut=100, colorkey=list(space="top"),
main="Mean Time of Emergence of Climate Change"
)
r <- mask(overlay(subset(cimp5_sdtoe_early, 1:4), fun=max), mask200)
p2 <- mplot(r, col.regions=d.colors, cut=100, colorkey=list(space="top"),
main="Maximum Time of Emergence of Climate Change"
)
print(p1, split=c(1,1,2,1), more=TRUE)
print(p2, split=c(2,1,2,1))
levs <- c(0:12, 53, 56)
labs <-c("Land mass", "Atlantic Ocean", "Pacific Ocean", "Indian Ocean", "Mediterranean Sea", "Baltic Sea", "Black Sea", "Red Sea", "Persian Gulf", "Hudson Bay", "Southern Ocean", "Arctic Ocean", "Sea of Japan", "Caspian Sea", "Bay of Bengal")
mplot(mk, col.regions=rainbow, at=c(0:12, 53,56), colorkey=F)
names(cimp5_sdtoe_early)
subset(cimp5_sdtoe_early, c(1:4, 10:11))
library(doBy)
library(knitr)
library(ggplot2)
library(reshape2)
env <- mask(subset(cimp5_sdtoe_early, c(1:4, 10:11)), mask200)
bas <- mask(mk, mask200)
dat <- cbind(as.data.frame(env), as.data.frame(bas))
dat <- subset(dat, !is.na(Basin_0m))
dat$Basin_0m <- factor(dat$Basin_0m, levels=levs, labels=labs)
sta <- summaryBy(epc_sdtoe_early+o2_sdtoe_early+ph_sdtoe_early+thetao_sdtoe_early+aragsat_sdtoe_early+calcsat_sdtoe_early~Basin_0m, data=dat, var.names=c("epc", "o2", "ph", "thetao"), FUN=c(mean, min, max))
ord <- c(2, 8, 14)
sta <- sta[, c(1, ord, ord+1, ord+2, ord+3, ord+4 , ord+5)]
sta[, -1] <- round(sta[, -1], 0)
kable(sta, caption = "Time of Emergence of Climate changes beyound 200 m")
env <- mask(subset(cimp5_sdtoe_early, c(1:4, 10:11)), mask200)
bas <- mask(mk, mask200)
dat <- cbind(as.data.frame(env), as.data.frame(bas))
dat <- subset(dat, !is.na(Basin_0m))
dat$Basin_0m <- factor(dat$Basin_0m, levels=levs, labels=labs)
sta <- summaryBy(epc_sdtoe_early+o2_sdtoe_early+ph_sdtoe_early+thetao_sdtoe_early+aragsat_sdtoe_early+calcsat_sdtoe_early~Basin_0m, data=dat, var.names=c("epc", "o2", "ph", "thetao", "aragsat", "calcsat"), FUN=c(mean, min, max))
ord <- c(2, 8, 14)
sta <- sta[, c(1, ord, ord+1, ord+2, ord+3, ord+4 , ord+5)]
sta[, -1] <- round(sta[, -1], 0)
kable(sta, caption = "Time of Emergence of Climate changes beyound 200 m")
library(doBy)
library(knitr)
library(ggplot2)
library(reshape2)
env <- mask(subset(cimp5_sdtoe_early, c(1:4, 10:11)), mask200)
bas <- mask(mk, mask200)
dat <- cbind(as.data.frame(env), as.data.frame(bas))
dat <- subset(dat, !is.na(Basin_0m))
dat$Basin_0m <- factor(dat$Basin_0m, levels=levs, labels=labs)
sta <- summaryBy(epc_sdtoe_early+o2_sdtoe_early+ph_sdtoe_early+thetao_sdtoe_early+aragsat_sdtoe_early+calcsat_sdtoe_early~Basin_0m, data=dat, var.names=c("epc", "o2", "ph", "thetao", "aragsat", "calcsat"), FUN=c(mean, min, max))
ord <- c(2, 8, 14)
sta <- sta[, c(1, ord, ord+1, ord+2, ord+3, ord+4 , ord+5)]
sta[, -1] <- round(sta[, -1], 0)
kable(sta, caption = "Time of Emergence of Climate changes beyound 200 m")
long <- melt(dat, id.vars="Basin_0m", measure.vars = names(dat)[c(1:4, 10:11)])
names(dat)
library(doBy)
library(knitr)
library(ggplot2)
library(reshape2)
env <- mask(subset(cimp5_sdtoe_early, c(1:4, 10:11)), mask200)
bas <- mask(mk, mask200)
dat <- cbind(as.data.frame(env), as.data.frame(bas))
dat <- subset(dat, !is.na(Basin_0m))
dat$Basin_0m <- factor(dat$Basin_0m, levels=levs, labels=labs)
sta <- summaryBy(epc_sdtoe_early+o2_sdtoe_early+ph_sdtoe_early+thetao_sdtoe_early+aragsat_sdtoe_early+calcsat_sdtoe_early~Basin_0m, data=dat, var.names=c("epc", "o2", "ph", "thetao", "aragsat", "calcsat"), FUN=c(mean, min, max))
ord <- c(2, 8, 14)
sta <- sta[, c(1, ord, ord+1, ord+2, ord+3, ord+4 , ord+5)]
sta[, -1] <- round(sta[, -1], 0)
kable(sta, caption = "Time of Emergence of Climate changes beyound 200 m")
names(dat)
long <- melt(dat, id.vars="Basin_0m", measure.vars = names(dat)[1:6])
long$Basin_0m <- factor(long$Basin_0m, levels=as.character(sta$Basin_0m)[order(sta$thetao.mean)])
long$variable <- factor(long$variable, levels=names(dat)[1:6],
labels = c("Export POC Flux", "Dissolved Oxygen",
"pH", "Temperature", "Aragonite Saturation", "Calcite Saturation"))
ggplot(data=long, aes(x=Basin_0m, y=value))+
geom_violin(draw_quantiles=0.5, scale="width")+
xlab("")+ylab("Time of Emergence of Climate Changes")+
facet_wrap(~variable, scale="free_y")+
theme(axis.text.x = element_text(angle = 30, hjust = 1))
other <- mask(rasterize(Other_access_regulated_areas, subset(cimp5_sdtoe_early), c(1:4, 10:11)), mask200)
subset(cimp5_sdtoe_early), c(1:4, 10:11))
other <- mask(rasterize(Other_access_regulated_areas, subset(cimp5_sdtoe_early, c(1:4, 10:11))), mask200)
dat <- cbind(as.data.frame(env), as.data.frame(other))
dat <- subset(dat, !is.na(OWNER))
dat$OWNER <- factor(dat$OWNER)
ames(dat)
names(dat)
sta <- summaryBy(formula(paste(paste(names(dat)[1:6], collapse = "+"), "OWNER", sep="~")),
data=dat, var.names=c("epc", "o2", "ph", "thetao", "aragsat", "calcsat"), FUN=c(mean, min, max))
sta
ord <- c(2, 8, 14)
sta <- sta[, c(1, ord, ord+1, ord+2, ord+3, ord+4 , ord+5)]
sta[, -1] <- round(sta[, -1], 0)
kable(sta, caption = "Time of Emergence of Climate changes beyound 200 m")
names(dat)
ggplot(data=long, aes(x=OWNER, y=value))+
geom_violin(draw_quantiles=0.5, scale="width")+
xlab("")+ylab("Time of Emergence of Climate Changes")+
facet_wrap(~variable, scale="free_y")+
theme(axis.text.x = element_text(angle = 30, hjust = 1))
long <- melt(dat, id.vars="OWNER", measure.vars = names(dat)[1:6])
long$OWNER <- factor(long$OWNER, levels=as.character(sta$OWNER)[order(sta$thetao.mean)])
long$variable <- factor(long$variable, levels=names(dat)[1:6],
labels = c("Export POC Flux", "Dissolved Oxygen",
"pH", "Temperature", "Aragonite Saturation", "Calcite Saturation"))
ggplot(data=long, aes(x=OWNER, y=value))+
geom_violin(draw_quantiles=0.5, scale="width")+
xlab("")+ylab("Time of Emergence of Climate Changes")+
facet_wrap(~variable, scale="free_y")+
theme(axis.text.x = element_text(angle = 30, hjust = 1))
env <- mask(subset(cimp5_sdtoe_early, c(1:4, 10:11)), mask2500)
bas <- mask(mk, mask2500)
dat <- cbind(as.data.frame(env), as.data.frame(bas))
dat <- subset(dat, !is.na(Basin_0m))
dat$Basin_0m <- factor(dat$Basin_0m, levels=levs, labels=labs)
sta <- summaryBy(epc_sdtoe_early+o2_sdtoe_early+ph_sdtoe_early+thetao_sdtoe_early+aragsat_sdtoe_early+calcsat_sdtoe_early~Basin_0m, data=dat, var.names=c("epc", "o2", "ph", "thetao", "aragsat", "calcsat"), FUN=c(mean, min, max))
ord <- c(2, 8, 14)
sta <- sta[, c(1, ord, ord+1, ord+2, ord+3, ord+4 , ord+5)]
sta[, -1] <- round(sta[, -1], 0)
kable(sta, caption = "Time of Emergence of Climate changes beyound 200 m")
long <- melt(dat, id.vars="Basin_0m", measure.vars = names(dat)[1:6])
long$Basin_0m <- factor(long$Basin_0m, levels=as.character(sta$Basin_0m)[order(sta$thetao.mean)])
long$variable <- factor(long$variable, levels=names(dat)[1:6],
labels = c("Export POC Flux", "Dissolved Oxygen",
"pH", "Temperature", "Aragonite Saturation", "Calcite Saturation"))
ggplot(data=long, aes(x=Basin_0m, y=value))+
geom_violin(draw_quantiles=0.5, scale="width")+
xlab("")+ylab("Time of Emergence of Climate Changes")+
facet_wrap(~variable, scale="free_y")+
theme(axis.text.x = element_text(angle = 30, hjust = 1))
other <- mask(rasterize(Other_access_regulated_areas, subset(cimp5_sdtoe_early, c(1:4, 10:11))), mask2500)
dat <- cbind(as.data.frame(env), as.data.frame(other))
dat <- subset(dat, !is.na(OWNER))
dat$OWNER <- factor(dat$OWNER)
sta <- summaryBy(formula(paste(paste(names(dat)[1:6], collapse = "+"), "OWNER", sep="~")),
data=dat, var.names=c("epc", "o2", "ph", "thetao", "aragsat", "calcsat"), FUN=c(mean, min, max))
ord <- c(2, 8, 14)
sta <- sta[, c(1, ord, ord+1, ord+2, ord+3, ord+4 , ord+5)]
sta[, -1] <- round(sta[, -1], 0)
kable(sta, caption = "Time of Emergence of Climate changes beyound 200 m")
long <- melt(dat, id.vars="OWNER", measure.vars = names(dat)[1:6])
long$OWNER <- factor(long$OWNER, levels=as.character(sta$OWNER)[order(sta$thetao.mean)])
long$variable <- factor(long$variable, levels=names(dat)[1:6],
labels = c("Export POC Flux", "Dissolved Oxygen",
"pH", "Temperature", "Aragonite Saturation", "Calcite Saturation"))
ggplot(data=long, aes(x=OWNER, y=value))+
geom_violin(draw_quantiles=0.5, scale="width")+
xlab("")+ylab("Time of Emergence of Climate Changes")+
facet_wrap(~variable, scale="free_y")+
theme(axis.text.x = element_text(angle = 30, hjust = 1))
cimp5_sdtoe_constant
library(SCC85)
?SCC85
library(devtools)
install_github("chihlinwei/SCC26")
library(SCC85)
